<fieldset>
  <div class="form-card">
    <div class="secondary-container title-bar">
      <div class="row">
        <div class="col-8">
          <h2 class="fs-title">Birth and Developmental History:</h2>
        </div>
        <div class="col-4">
          <h2 class="steps">Step 1 - 5</h2>
        </div>
      </div>
    </div>

    <div id="addPlace1"></div>
    
    <div class="secondary-container">
      <h4 class="subsection-title">Birth history</h4>
      <label class="fieldlabels">Where were you born? </label>
      <input type="text" name="birth_place" placeholder="" />

      <label class="fieldlabels">Type of delivery? </label>
      <br />
      <div class="row">
        <div class="col">
          <div class="custom-control custom-radio">
            <input
              type="radio"
              class="custom-control-input"
              id="normalDelivery"
              name="deliveryType"
              value="Normal Vaginal Delivery(NVD)"
            />
            <label class="custom-control-label" for="normalDelivery">
              Normal Vaginal Delivery(NVD)
            </label>
          </div>
        </div>
        <div class="col">
          <div class="custom-control custom-radio">
            <input
              type="radio"
              class="custom-control-input"
              id="caesareanDelivery"
              name="deliveryType"
              value="Caesarean Section(CS)"
            />
            <label class="custom-control-label" for="caesareanDelivery">
              Caesarean Section(CS)
            </label>
          </div>
        </div>
        <div class="col"></div>
      </div>
      <br />

      <label class="fieldlabels"
        >During which week of pregnancy did your delivery take place??
      </label>
      <input type="number" step="0.01" name="deleveryWeek" placeholder="" />

      <label class="fieldlabels"
        >What was your weight at the time of birth?(In Kg)
      </label>
      <input type="number" name="birthWeight" placeholder="" />

      <label class="fieldlabels">Were there any complications? </label>
      <br />
      <div class="row">
        <div class="col">
          <div class="custom-control custom-checkbox">
            <input
              type="radio"
              class="custom-control-input"
              id="complicationsYes"
              name="complications"
              value="yes"
            />
            <label class="custom-control-label" for="complicationsYes">
              Yes
            </label>
          </div>
        </div>
        <div class="col">
          <div class="custom-control custom-checkbox">
            <input
              type="radio"
              class="custom-control-input"
              id="complicationsNo"
              name="complications"
              value="no"
              checked
            />
            <label class="custom-control-label" for="complicationsNo">
              No
            </label>
          </div>
        </div>
        <div class="col"></div>
      </div>
      <br />

      <h4 class="subsection-title">Development history</h4>

      <label class="fieldlabels"
        >When did you first sit?(answer in month. e.g. 6th month)
      </label>
      <input type="number" name="first_sit" placeholder="" />
      <label class="fieldlabels">When did you walk? </label>
      <input type="text" name="first_walk" placeholder="" />

      <label class="fieldlabels">Can you give a social smile? </label>
      <br />
      <div class="row">
        <div class="col">
          <div class="custom-control custom-checkbox">
            <input
              type="radio"
              class="custom-control-input"
              id="canGiveSocialSmile"
              name="socialSmile"
              value="yes"
              checked
            />
            <label class="custom-control-label" for="canGiveSocialSmile">
              Yes
            </label>
          </div>
        </div>
        <div class="col">
          <div class="custom-control custom-checkbox">
            <input
              type="radio"
              class="custom-control-input"
              id="canNotGiveSocialSmile"
              name="socialSmile"
              value="no"
            />
            <label class="custom-control-label" for="canNotGiveSocialSmile">
              No
            </label>
          </div>
        </div>
        <div class="col"></div>
      </div>
      <br />

      <label class="fieldlabels">Were your linguistic development late </label>
      <br />
      <div class="row">
        <div class="col">
          <div class="custom-control custom-checkbox">
            <input
              type="radio"
              class="custom-control-input"
              id="linguisticDevLate"
              name="linguisticDevelopment"
              value="yes"
            />
            <label class="custom-control-label" for="linguisticDevLate">
              Yes
            </label>
          </div>
        </div>
        <div class="col">
          <div class="custom-control custom-checkbox">
            <input
              type="radio"
              class="custom-control-input"
              id="linguisticDevNotLate"
              name="linguisticDevelopment"
              value="no"
              checked
            />
            <label class="custom-control-label" for="linguisticDevNotLate">
              No
            </label>
          </div>
        </div>
        <div class="col"></div>
      </div>
      <br />

      <label class="fieldlabels">When could you first speak normally? </label>
      <input type="text" name="first_speak" placeholder="" />
      <br />
    </div>

    <div class="secondary-container">
      <h4 class="subsection-title">Immunization history</h4>

      <div class="family-container">
        <div class="part">
          <div class="sub-part-row">
            <h5 class="left">Add vaccine information</h5>
            <!-- <button type="button" class="btn btn-outline-light add" onclick="addVaccineDetails()"></button> -->
          </div>

          <% if(typeof vaccineInfoJson != 'undefined'){ %> <% for(let i = 0 ; i
          < vaccineInfoJson.length ; i++) {%>

          <div class="sub-part each-vaccine-info">
            <div class="vaccine-info-subsection">
              <label class="fieldlabels">Vaccine name</label>
              <p class="vaccineName"><%= vaccineInfoJson[i].name %></p>
            </div>

            <div class="vaccine-info-subsection">
              <label class="fieldlabels">Disases</label>
              <p class="vaccineForDiseases">
                <%= vaccineInfoJson[i].diseases %>
              </p>
            </div>

            <div class="vaccine-info-subsection">
              <label class="fieldlabels">Status</label>
              <div class="row">
                <div class="col">
                  <div class="custom-control custom-checkbox">
                    <input
                      type="radio"
                      class="custom-control-input"
                      id="vaccine<%= vaccineInfoJson[i].name %>Completed"
                      name="<%= vaccineInfoJson[i].name %>"
                      value="completed"
                      checked
                    />
                    <label
                      class="custom-control-label"
                      for="vaccine<%= vaccineInfoJson[i].name %>Completed"
                    >
                      completed
                    </label>
                  </div>
                </div>
                <div class="col">
                  <div class="custom-control custom-checkbox">
                    <input
                      type="radio"
                      class="custom-control-input"
                      id="vaccine<%= vaccineInfoJson[i].name %>NotCompleted"
                      name="<%= vaccineInfoJson[i].name %>"
                      value="incomplete"
                    />
                    <label
                      class="custom-control-label"
                      for="vaccine<%= vaccineInfoJson[i].name %>NotCompleted"
                    >
                      incomplete
                    </label>
                  </div>
                </div>
                <div class="col"></div>
              </div>
            </div>
          </div>

          <% } %> <% } %>
        </div>
      </div>
    </div>
  </div>
  <input type="button" name="next" class="next action-button" value="Next" />
  <script>
    // $.get("/admin/getSectionData/Birth and Developmental History", (data) => {
    //   let elmStr = "";
    //   for (let i = 0; i < data.subSections.length; i++) {
    //     elmStr += getSubSectionStr(data.subSections[i]);
    //   }
    //   $("#addPlace1").replaceWith(elmStr);
    // });

    function getSubSectionStr(subSection) {
      let elmStr = "";
      elmStr += '<h4 class="subsection-title">' + subSection.name + "</h4>";
      for (let i = 0; i < subSection.questions.length; i++) {
        elmStr += getQuestionStr(subSection.questions[i]);
      }

      return '<div class="secondary-container">' + elmStr + "</div>";
    }
    function getQuestionStr(question) {
      let elmStr = "";
      elmStr += '<label class="fieldlabels">' + question.name + "</label>";
      if (question.inputType == "numerical")
        elmStr +=' <input type="number" name="' + question._id + '" placeholder="" />';
      else if (question.inputType == "date")
        elmStr +=' <input type="date" name="' + question._id + '" placeholder="" />';
      else if (question.inputType == "singleLine")
        elmStr +=' <input type="text" name="' + question._id + '" placeholder="" />';
      else if (question.inputType == "multiLine")
        elmStr +='<textarea class="form-control" name="' + question._id + '"  rows="3"></textarea>'
      else if (question.inputType == "multiChoiceSingleAns")
        elmStr += getMultiChoiceSingleOp(question._id, question.options)
      else if (question.inputType == "multiChoiceMultiAns")
        elmStr += getMultiChoiceMultiOp(question._id, question.options)

      return elmStr+ '<br>';
    }

    function getMultiChoiceSingleOp(qId, options){
        let elmStr = ''
        let conditionalPart='', condArrayStr = '['

        for(let i=0; i<options.length; i++){
          if(options[i].questions.length>0)
            condArrayStr += '\'conditional'+options[i]._id+'\', '
        }
        condArrayStr+=']'

        for(let i=0; i<options.length; i++){
          if(options[i].questions.length>0){
            let str = "\'conditional"+options[i]._id+"\'," 
            let newCondArray = condArrayStr.replace(str, '')
            elmStr += '<div class="custom-control custom-radio">'+
            '<input type="radio" id="'+options[i]._id+'" name="'+ qId +'" class="custom-control-input" value="'+options[i].name+'" onclick="hideConditionalSection('+newCondArray+'); displayConditionalSection([\'conditional'+options[i]._id+'\']); ">'+
            '<label class="custom-control-label" for="'+options[i]._id+'">'+options[i].name+'</label>'+
            '</div>'
            let qStr = ''
            for(let j=0; j<options[i].questions.length; j++){
              qStr+= getQuestionStr(options[i].questions[j])
            }
            conditionalPart += '<div id= "conditional'+options[i]._id+'" style="display: none;">'+ qStr +'</div>'
          }
          else{
            elmStr += '<div class="custom-control custom-radio">'+
            '<input type="radio" id="'+options[i]._id+'" name="'+ qId +'" class="custom-control-input" value="'+options[i].name+'" onclick="hideConditionalSection('+condArrayStr+');">'+
            '<label class="custom-control-label" for="'+options[i]._id+'">'+options[i].name+'</label>'+
            '</div>'
          }
        }
        return elmStr+conditionalPart
    }

    function getMultiChoiceMultiOp(qId, options){
      let elmStr = ''

      for(let i=0; i<options.length; i++){
        elmStr += '<div class="custom-control custom-checkbox">'+
          '<input type="checkbox" id="'+options[i]._id+'" name="'+ qId +'" class="custom-control-input" value="'+options[i].name+'" onclick="displayConditionalSectionCheckbox(\''+options[i]._id+'\' , \'conditional'+options[i]._id+'\'); ">'+
          '<label class="custom-control-label" for="'+options[i]._id+'">'+options[i].name+'</label>'+
          '</div>'
        
        if(options[i].questions.length>0){  
          let qStr = ''
          for(let j=0; j<options[i].questions.length; j++){
            qStr+= getQuestionStr(options[i].questions[j])
          }
          elmStr += '<div id= "conditional'+options[i]._id+'" style="display: none;">'+ qStr +'</div>'
        }
      }
      return elmStr
    }
  </script>
</fieldset>
